--TASK3
--14. FIND THE TOTAL NUMBER OF COURIERS HANDLED BY EACH EMPLOYEE
select LocationID, COUNT(CourierID) as TotalCouriersHandled
from Payment
group by LocationID

--15. CALCULATE THE TOTAL REVENUE GENERATED BY EACH LOCATION
select LocationID, SUM(Amount) as TotalRevenue
from Payment
group by LocationID

--16. FIND THE TOTAL NUMBER OF COURIERS DELIVERED TO EACH LOCATION
select
convert(varchar(255), ReceiverAddress) as Locations, 
count(CourierID) as TotalDelivered
from Courier
where CourierStatus = 'Delivered'
group by convert(varchar(255), ReceiverAddress)

--17. FIND THE COURIER WITH HIGHEST AVERAGE DELIVERY TIME
select top 1 TrackingNumber, 
avg(datediff(day, PaymentDate, DeliveryDate)) as AvgDeliveryTime
from Courier C
join Payment P on C.CourierID = P.CourierID
group by TrackingNumber
order by AvgDeliveryTime desc

--18. FIND LOCATIONS WITH TOTAL PAYMENTS LESS THAN A CERTAIN AMOUNT
select LocationID, sum(Amount) as TotalPayments
from Payment
group by LocationID
having sum(Amount)<350
order by TotalPayments asc

--19. CALCULATE TOTAL PAYMENTS PER LOCATION
select LocationID, sum(Amount) as TotalPayments
from Payment
group by LocationID
order by TotalPayments desc

--20. RETRIEVE COURIERS WHO HAVE RECEIVED PAYMENTS TOTALING MORE THAN 100 IN A SPECIFIC LOCATION
select CourierID, SUM(Amount) AS TotalPayment
from Payment
where LocationID = 6300230
group by CourierID
having sum(Amount) > 100

--21. RETRIEVE COURIERS WHO HAVE RECEIVED PAYMENTS TOTALING MORE THAN 150 AFTER A CERTAIN DATE (PAYMENTDATE>'YYYY-MM-DD')
select CourierID, sum(Amount) as TotalPayment
from Payment
where PaymentDate > '2025-03-15'
group by CourierID
having sum(Amount) > 150

--22. RETRIEVE LOCATIONS WHERE THE TOTAL AMOUNT RECEIVED IS MORE THAN 200 BEFORE A CERTAIN DATE (PAYMENTDATE>'YYYY-MM-DD')
select LocationID, sum(Amount) as TotalAmountReceived
from Payment
where PaymentDate < '2025-03-20'
group by LocationID
having sum(Amount) > 200